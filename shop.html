<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alameda - Elevated Shop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --bg-color: #ffffff;
            --text-main: #111111;
            --text-muted: #777777;
            --text-light: #999999;
            --border-color: #eeeeee;
            --accent-color: #000000;
            --transition-smooth: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        /* --- RESET & BASIC SETUP --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Jost', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            font-size: 15px;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }

        a { text-decoration: none; color: inherit; cursor: pointer; transition: color 0.3s ease; }
        ul { list-style: none; }

        /* --- STICKY HEADER --- */
        header {
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 25px 50px;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid transparent;
            transition: var(--transition-smooth);
        }
        
        header.scrolled {
            padding: 15px 50px;
            border-bottom: 1px solid var(--border-color);
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
        }

        /* Nav Left */
        .nav-left ul { display: flex; gap: 30px; }
        .nav-left a { font-weight: 400; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); }
        .nav-left a:hover { color: var(--text-main); }

        /* Logo */
        .logo { font-size: 28px; font-weight: 500; letter-spacing: 2px; text-transform: uppercase; text-align: center; }

        /* Nav Right */
        .nav-right { display: flex; justify-content: flex-end; gap: 25px; align-items: center; }
        .icon { width: 20px; height: 20px; fill: var(--text-main); transition: transform 0.3s ease; }
        .nav-right a:hover .icon { transform: translateY(-2px); }
        .cart-wrap { display: flex; align-items: center; gap: 6px; font-weight: 500; }
        .cart-count { background: var(--text-main); color: #fff; font-size: 10px; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }

        /* Mobile Hamburger */
        .hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; z-index: 101; }
        .hamburger span { width: 25px; height: 2px; background: var(--text-main); transition: var(--transition-smooth); }

        /* Mobile Menu Overlay */
        .mobile-menu {
            position: fixed; top: 0; left: -100%; width: 80%; max-width: 400px; height: 100vh;
            background: #fff; z-index: 99; padding: 100px 40px; box-shadow: 20px 0 50px rgba(0,0,0,0.05);
            transition: var(--transition-smooth); display: flex; flex-direction: column; gap: 20px;
        }
        .mobile-menu.active { left: 0; }
        .mobile-menu a { font-size: 20px; font-weight: 400; text-transform: uppercase; letter-spacing: 1px; }

        /* --- CATEGORY SUB-NAV (Desktop Default) --- */
        .category-nav { text-align: center; margin: 40px 0 60px 0; padding: 0 20px; }
        .category-nav ul { display: inline-flex; gap: 40px; }
        .category-nav a { color: var(--text-light); font-size: 13px; text-transform: uppercase; letter-spacing: 1.5px; padding-bottom: 5px; position: relative; }
        .category-nav a::after {
            content: ''; position: absolute; bottom: 0; left: 50%; width: 0; height: 1px; background: var(--text-main);
            transition: var(--transition-smooth); transform: translateX(-50%);
        }
        .category-nav a:hover, .category-nav a.active { color: var(--text-main); }
        .category-nav a.active::after { width: 100%; }

        /* Hidden on Desktop */
        .mobile-filter-btn { display: none; }
        .filter-overlay { display: none; }
        .close-popup-wrap { display: none; }

        /* --- PRODUCT GRID --- */
        .container { max-width: 1400px; margin: 0 auto; padding: 0 50px; min-height: 50vh; }
        .product-grid { display: grid; grid-template-columns: repeat(4, 1fr); column-gap: 30px; row-gap: 60px; margin-bottom: 100px; }
        .product-card.hidden { display: none; }
        .product-card {
            display: flex; flex-direction: column; position: relative;
            animation: fadeIn 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .product-image-wrap {
            position: relative; width: 100%; padding-bottom: 130%; background-color: #f8f8f8;
            margin-bottom: 20px; cursor: pointer; overflow: hidden; border-radius: 4px;
        }

        .product-image { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; transition: transform 0.8s ease; }
        .product-card:hover .product-image { transform: scale(1.05); }

        /* Stylish Quick View Button */
        .quick-view-btn {
            background-color: rgba(255, 255, 255, 0.95); color: var(--text-main); font-weight: 500;
            padding: 15px 0; font-size: 11px; letter-spacing: 2px; text-align: center;
            position: absolute; bottom: -60px; left: 0; width: 100%; transition: var(--transition-smooth);
            backdrop-filter: blur(5px);
        }
        .product-image-wrap:hover .quick-view-btn { bottom: 0; }
        .quick-view-btn:hover { background-color: var(--text-main); color: #fff; }

        .product-info { display: flex; justify-content: space-between; align-items: flex-start; }
        .product-text { display: flex; flex-direction: column; gap: 4px; }
        .product-title { font-size: 15px; font-weight: 400; letter-spacing: 0.5px; }
        .product-price { font-size: 14px; color: var(--text-muted); }
        .original-price { text-decoration: line-through; color: var(--text-light); margin-right: 8px; font-size: 13px; }
        .sale-tag { font-size: 10px; text-transform: uppercase; letter-spacing: 1px; background: #e7e7e7; padding: 3px 8px; border-radius: 2px; color: var(--text-main); }

        /* --- FOOTER SECTION --- */
        footer { background-color: #fafafa; padding: 80px 0 40px 0; margin-top: 60px; border-top: 1px solid var(--border-color); }
        .footer-lookbook { text-align: center; }
        .lookbook-title { font-size: 20px; letter-spacing: 3px; margin-bottom: 30px; text-transform: uppercase; font-weight: 400; }
        
        .footer-social { display: flex; justify-content: center; gap: 30px; margin-bottom: 50px; }
        .footer-social .icon { fill: var(--text-muted); }
        .footer-social a:hover .icon { fill: var(--text-main); }

        .newsletter { max-width: 450px; margin: 0 auto 60px auto; padding: 0 20px; }
        .newsletter p { margin-bottom: 25px; font-size: 14px; color: var(--text-muted); letter-spacing: 0.5px; }
        .newsletter-form { display: flex; border-bottom: 1px solid var(--border-color); padding-bottom: 5px; }
        .newsletter-input { flex: 1; padding: 10px 0; border: none; font-size: 14px; background: transparent; outline: none; font-family: 'Jost', sans-serif; }
        .newsletter-btn { background: transparent; color: var(--text-main); border: none; font-size: 13px; font-weight: 500; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; padding: 0 10px; transition: color 0.3s; }
        .newsletter-btn:hover { color: var(--text-light); }

        .copyright { font-size: 12px; color: var(--text-light); text-align: center; letter-spacing: 1px; }

        /* --- RESPONSIVE DESIGN --- */
        @media (max-width: 1100px) {
            .product-grid { grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 850px) {
            header { padding: 20px 30px; }
            header.scrolled { padding: 10px 30px; }
            .container { padding: 0 30px; }
            .product-grid { grid-template-columns: repeat(2, 1fr); gap: 20px; row-gap: 40px; }
            .nav-left { display: none; }
            .hamburger { display: flex; }
        }

        /* --- MOBILE SPECIFIC LOGIC (Category Popup) --- */
        @media (max-width: 550px) {
            header { padding: 15px 20px; grid-template-columns: auto 1fr auto; }
            header.scrolled { padding: 10px 20px; }
            .logo { font-size: 20px; }
            .nav-right { gap: 15px; }
            .container { padding: 0 15px; }
            .product-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; row-gap: 30px; margin-bottom: 60px; }
            .product-title, .product-price { font-size: 13px; }
            .quick-view-btn { display: none; }
            footer { padding: 50px 0 30px 0; }

            /* Mobile Filter Button */
            .mobile-filter-btn {
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: calc(100% - 30px);
                margin: 20px auto 30px auto;
                padding: 14px 20px;
                background: #fff;
                border: 1px solid var(--border-color);
                border-radius: 4px;
                font-family: 'Jost', sans-serif;
                font-size: 13px;
                text-transform: uppercase;
                letter-spacing: 1px;
                cursor: pointer;
                color: var(--text-main);
                box-shadow: 0 2px 10px rgba(0,0,0,0.02);
            }
            .mobile-filter-btn .icon { width: 14px; height: 14px; transition: transform 0.3s; }

            /* Popup Overlay */
            .filter-overlay {
                display: block;
                position: fixed;
                top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.5);
                backdrop-filter: blur(2px);
                z-index: 105;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s ease;
            }
            .filter-overlay.active {
                opacity: 1; pointer-events: auto;
            }

            /* Category Popup Drawer */
            .category-nav { margin: 0; padding: 0; }
            .category-nav ul {
                display: flex;
                position: fixed;
                bottom: -100%; left: 0; width: 100%;
                background: #fff;
                z-index: 106;
                flex-direction: column;
                padding: 25px 30px 40px 30px;
                border-radius: 20px 20px 0 0;
                gap: 20px;
                transition: bottom 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
                box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
            }
            .category-nav ul.active { bottom: 0; }
            
            /* Close Popup Header */
            .close-popup-wrap {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 10px;
                border-bottom: 1px solid var(--border-color);
                padding-bottom: 15px;
                width: 100%;
            }
            .close-popup-wrap span { font-weight: 500; font-size: 12px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--text-muted); }
            .close-popup-wrap button { background: none; border: none; font-size: 28px; line-height: 1; cursor: pointer; color: var(--text-main); }
            
            /* Mobile Link Styles */
            .category-nav a { font-size: 16px; display: block; text-align: left; padding: 5px 0; }
            .category-nav a::after { display: none; } /* Remove desktop underline */
        }
    </style>
</head>
<body>

    <header id="mainHeader">
        <div class="hamburger" id="hamburgerBtn">
            <span></span><span></span><span></span>
        </div>

        <nav class="nav-left">
            <ul>
                <li><a href="#">Shop</a></li>
                <li><a href="#">Lookbook</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav>

        <a href="#" class="logo">Alameda</a>

        <div class="nav-right">
            <a href="#" class="hide-mobile">
                <svg class="icon" viewBox="0 0 24 24"><path d="M7.8,2H16.2C19.4,2 22,4.6 22,7.8V16.2A5.8,5.8 0 0,1 16.2,22H7.8C4.6,22 2,19.4 2,16.2V7.8A5.8,5.8 0 0,1 7.8,2M7.6,4A3.6,3.6 0 0,0 4,7.6V16.4C4,18.39 5.61,20 7.6,20H16.4A3.6,3.6 0 0,0 20,16.4V7.6C20,5.61 18.39,4 16.4,4H7.6M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M19,5A1,1 0 0,1 20,6A1,1 0 0,1 19,7A1,1 0 0,1 18,6A1,1 0 0,1 19,5Z" /></svg>
            </a>
            <a href="cart.html" class="cart-wrap" id="cartBtn">
                <svg class="icon" viewBox="0 0 24 24"><path d="M17,18C15.89,18 15,18.89 15,20A2,2 0 0,0 17,22A2,2 0 0,0 19,20C19,18.89 18.1,18 17,18M1,2V4H3L6.6,11.59L5.25,14.04C5.09,14.32 5,14.65 5,15A2,2 0 0,0 7,17H19V15H7.42A0.25,0.25 0 0,1 7.17,14.75C7.17,14.7 7.18,14.66 7.2,14.63L8.1,13H15.55C16.3,13 16.96,12.59 17.3,11.97L21.16,4.96L19.42,4H19.41L18.31,6L15.55,11H8.53L8.4,10.73L6.16,6L5.21,4L4.27,2H1M7,18C5.89,18 5,18.89 5,20A2,2 0 0,0 7,22A2,2 0 0,0 9,20C9,18.89 8.1,18 7,18Z"/></svg>
                <span class="cart-count">0</span>
            </a>
        </div>
    </header>

    <div class="mobile-menu" id="mobileMenu">
        <a href="#">Shop</a>
        <a href="#">Lookbook</a>
        <a href="#">About</a>
        <a href="#">Contact</a>
    </div>

    <button class="mobile-filter-btn" id="mobileFilterBtn">
        <span id="currentCategoryText">All Categories</span>
        <svg viewBox="0 0 24 24" class="icon"><path d="M7 10l5 5 5-5z"/></svg>
    </button>

    <div class="filter-overlay" id="filterOverlay"></div>

    <nav class="category-nav">
        <ul id="categoryPopup">
            <li class="close-popup-wrap">
                <span>Filter By</span>
                <button id="closePopupBtn">&times;</button>
            </li>
            <li><a href="#" class="active" data-filter="all">All Categories</a></li>
            <li><a href="#" data-filter="tops">Tops</a></li>
            <li><a href="#" data-filter="bottoms">Bottoms</a></li>
            <li><a href="#" data-filter="sale">Sale</a></li>
        </ul>
    </nav>

    <main class="container">
        <div class="product-grid" id="productGrid"></div>
    </main>

    <footer>
        <div class="footer-lookbook">
            <h2 class="lookbook-title">Spring / Summer</h2>
            <div class="footer-social">
                <a href="#"><svg class="icon" viewBox="0 0 24 24"><path d="M7.8,2H16.2C19.4,2 22,4.6 22,7.8V16.2A5.8,5.8 0 0,1 16.2,22H7.8C4.6,22 2,19.4 2,16.2V7.8A5.8,5.8 0 0,1 7.8,2M7.6,4A3.6,3.6 0 0,0 4,7.6V16.4C4,18.39 5.61,20 7.6,20H16.4A3.6,3.6 0 0,0 20,16.4V7.6C20,5.61 18.39,4 16.4,4H7.6M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M19,5A1,1 0 0,1 20,6A1,1 0 0,1 19,7A1,1 0 0,1 18,6A1,1 0 0,1 19,5Z" /></svg></a>
            </div>
            <div class="newsletter">
                <p>Sign up to receive news and updates.</p>
                <div class="newsletter-form">
                    <input type="email" placeholder="Enter your email" class="newsletter-input">
                    <button class="newsletter-btn">Subscribe</button>
                </div>
            </div>
            <div class="copyright">Â© 2026 Alameda</div>
        </div>
    </footer>

    <script type="module">
        // 1. Import Firebase SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // 2. Your Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB_Fie9L6bhvkPHwvbleyKeMLgd1cEEXy4",
            authDomain: "shapers-studio.firebaseapp.com",
            projectId: "shapers-studio",
            storageBucket: "shapers-studio.firebasestorage.app",
            messagingSenderId: "1038113921050",
            appId: "1:1038113921050:web:9901a2b191bbf91e9099a3"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 3. Helper to update cart count in header
        function updateHeaderCartCount() {
            const cart = JSON.parse(localStorage.getItem('alamedaCart')) || [];
            const totalItems = cart.reduce((acc, item) => acc + item.quantity, 0);
            const cartCountEl = document.querySelector('.cart-count');
            if(cartCountEl) cartCountEl.innerText = totalItems;
        }

        // 4. Fetch and Render Products
        async function fetchProducts() {
            const productGrid = document.getElementById('productGrid');
            productGrid.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">Loading products...</p>';

            updateHeaderCartCount(); // Initialize count on load

            try {
                const querySnapshot = await getDocs(collection(db, "products"));
                let html = '';

                querySnapshot.forEach((doc) => {
                    const product = doc.data();
                    
                    // Handle Sale Pricing Logic
                    const priceHtml = product.isSale && product.originalPrice 
                        ? `<span class="original-price">$${product.originalPrice.toFixed(2)}</span> $${product.price.toFixed(2)}`
                        : `$${product.price.toFixed(2)}`;

                    const saleTagHtml = product.isSale ? `<span class="sale-tag">Sale</span>` : '';

                    // IMPORTANT: Added data attributes for cart logic to the button
                    html += `
                        <a href="product.html?id=${doc.id}" class="product-card" data-category="${product.category || 'all'}">
                            <div class="product-image-wrap">
                                <img src="${product.imageUrl}" alt="${product.title}" class="product-image">
                                <div class="quick-view-btn" 
                                     data-id="${doc.id}"
                                     data-title="${product.title}"
                                     data-price="${product.price}"
                                     data-image="${product.imageUrl}">
                                     ADD TO CART
                                </div>
                            </div>
                            <div class="product-info">
                                <div class="product-text">
                                    <span class="product-title">${product.title}</span>
                                    <span class="product-price">${priceHtml}</span>
                                </div>
                                ${saleTagHtml}
                            </div>
                        </a>
                    `;
                });

                productGrid.innerHTML = html;
                
                // Initialize the UI elements (Filtering, Cart, etc.) AFTER rendering
                initializeUI();

            } catch (error) {
                console.error("Error fetching products: ", error);
                productGrid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: red;">Failed to load products.</p>';
            }
        }

        // 5. Your Existing UI Logic
        function initializeUI() {
            // --- 1. Product Filtering & Mobile Popup Logic ---
            const filterLinks = document.querySelectorAll('.category-nav a');
            const products = document.querySelectorAll('.product-card'); 
            
            const mobileFilterBtn = document.getElementById('mobileFilterBtn');
            const filterOverlay = document.getElementById('filterOverlay');
            const categoryPopup = document.getElementById('categoryPopup');
            const closePopupBtn = document.getElementById('closePopupBtn');
            const currentCatText = document.getElementById('currentCategoryText');

            if(mobileFilterBtn) {
                mobileFilterBtn.addEventListener('click', () => {
                    filterOverlay.classList.add('active');
                    categoryPopup.classList.add('active');
                });
            }

            const closePopup = () => {
                filterOverlay.classList.remove('active');
                categoryPopup.classList.remove('active');
            };

            if(closePopupBtn) closePopupBtn.addEventListener('click', closePopup);
            if(filterOverlay) filterOverlay.addEventListener('click', closePopup);

            filterLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    filterLinks.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');

                    if (window.innerWidth <= 550) {
                        currentCatText.innerText = link.innerText;
                        closePopup();
                    }

                    const filterValue = link.getAttribute('data-filter');
                    products.forEach(product => {
                        const productCategories = product.getAttribute('data-category').split(' ');
                        if (filterValue === 'all' || productCategories.includes(filterValue)) {
                            product.classList.remove('hidden');
                        } else {
                            product.classList.add('hidden');
                        }
                    });
                });
            });

            // --- 2. Sticky Header Shadow ---
            const header = document.getElementById('mainHeader');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 10) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });

            // --- 3. Mobile Menu Toggle ---
            const hamburgerBtn = document.getElementById('hamburgerBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            let menuOpen = false;

            hamburgerBtn.addEventListener('click', () => {
                menuOpen = !menuOpen;
                if (menuOpen) {
                    mobileMenu.classList.add('active');
                    hamburgerBtn.children[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
                    hamburgerBtn.children[1].style.opacity = '0';
                    hamburgerBtn.children[2].style.transform = 'rotate(-45deg) translate(5px, -5px)';
                } else {
                    mobileMenu.classList.remove('active');
                    hamburgerBtn.children[0].style.transform = 'none';
                    hamburgerBtn.children[1].style.opacity = '1';
                    hamburgerBtn.children[2].style.transform = 'none';
                }
            });

            // --- 4. REAL CART LOGIC (Updated from Visual-Only) ---
            const quickViewBtns = document.querySelectorAll('.quick-view-btn');

            quickViewBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault(); // Prevents navigating to product.html
                    e.stopPropagation(); // Prevents the click from bubbling up to the <a> tag
                    
                    // Construct Cart Item
                    const cartItem = {
                        id: btn.getAttribute('data-id'),
                        title: btn.getAttribute('data-title'),
                        price: parseFloat(btn.getAttribute('data-price')),
                        image: btn.getAttribute('data-image'),
                        size: 'Medium', // Default size for Quick Add
                        quantity: 1
                    };

                    // Logic to save to LocalStorage
                    let cart = JSON.parse(localStorage.getItem('alamedaCart')) || [];
                    
                    // Check if item already exists (same ID + Size)
                    const existingItemIndex = cart.findIndex(item => item.id === cartItem.id && item.size === cartItem.size);

                    if (existingItemIndex > -1) {
                        cart[existingItemIndex].quantity += 1;
                    } else {
                        cart.push(cartItem);
                    }

                    localStorage.setItem('alamedaCart', JSON.stringify(cart));
                    updateHeaderCartCount(); // Refresh the header number immediately

                    // Visual Feedback
                    const originalText = btn.innerText;
                    btn.innerText = "ADDED!";
                    btn.style.backgroundColor = "#4caf50"; 
                    btn.style.color = "#fff";
                    
                    setTimeout(() => {
                        btn.innerText = originalText;
                        btn.style.backgroundColor = "";
                        btn.style.color = "";
                    }, 2000);
                });
            });
        }

        // 6. Kick off the fetch on page load
        document.addEventListener('DOMContentLoaded', fetchProducts);

    </script>
</body>
</html>